{
	admin off
	auto_https off
	log {
		output file /var/log/caddy.log
		format console
	}
}

:80 {
	# Handle /yourapp paths - proxy to generated app on port 3000
	handle_path /yourapp/* {
		reverse_proxy localhost:3000
	}

	# Handle root /yourapp redirect
	redir /yourapp /yourapp/ 307

	# Static files for main application
	handle /static/* {
		root * /app/development/src
		file_server
	}

	# API endpoints for main application
	handle /api/* {
		reverse_proxy localhost:8000
	}

	# Health endpoint
	handle /health {
		reverse_proxy localhost:8000
	}

	# Main application routes
	handle /* {
		reverse_proxy localhost:8000 {
			# Health check for FastAPI app
			health_uri /health
			health_interval 30s
			health_timeout 5s
		}
	}
}
